/* Generated by Nim Compiler v2.2.2 */
/* Compiled for: Linux, wasm32, clang */
/* Command for C compiler:
   emcc -c -w -ferror-limit=3 -pthread -flto -O3   -I/home/gregis/.choosenim/toolchains/nim-2.2.2/lib -I/home/gregis/Projects/OneLastBeat/src -o /home/gregis/Projects/OneLastBeat/tmp/@mstage.nim.c.o /home/gregis/Projects/OneLastBeat/tmp/@mstage.nim.c */
#define NIM_INTBITS 32

#include "nimbase.h"
#include <string.h>
#include <math.h>
#undef LANGUAGE_C
#undef MIPSEB
#undef MIPSEL
#undef PPC
#undef R3000
#undef R4000
#undef i386
#undef linux
#undef mips
#undef near
#undef far
#undef powerpc
#undef unix
typedef struct tyObject_StageDefcolonObjectType___UcMaWIjGo9c5Bv0yG3660iQ tyObject_StageDefcolonObjectType___UcMaWIjGo9c5Bv0yG3660iQ;
typedef struct tyObject_RefHeader__gnJExvuIhzi79cQetGScWGg tyObject_RefHeader__gnJExvuIhzi79cQetGScWGg;
typedef struct tySequence__6eW0sN9cwnKC4gxJcPFupZQ tySequence__6eW0sN9cwnKC4gxJcPFupZQ;
typedef struct tySequence__6eW0sN9cwnKC4gxJcPFupZQ_Content tySequence__6eW0sN9cwnKC4gxJcPFupZQ_Content;
typedef struct tyObject_EnemyWrappedcolonObjectType___8yhvQa9cpB762Fw7uK9bMSCw tyObject_EnemyWrappedcolonObjectType___8yhvQa9cpB762Fw7uK9bMSCw;
typedef struct NimStrPayload NimStrPayload;
typedef struct NimStringV2 NimStringV2;
struct tyObject_RefHeader__gnJExvuIhzi79cQetGScWGg {
	NI rc;
	NI rootIdx;
};
struct tySequence__6eW0sN9cwnKC4gxJcPFupZQ {
  NI len; tySequence__6eW0sN9cwnKC4gxJcPFupZQ_Content* p;
};
struct tyObject_StageDefcolonObjectType___UcMaWIjGo9c5Bv0yG3660iQ {
	NIM_BOOL enable_pre_stage;
	NIM_BOOL enable_stage;
	tySequence__6eW0sN9cwnKC4gxJcPFupZQ enemies;
	NI stage_num;
};
struct NimStrPayload {
	NI cap;
	NIM_CHAR data[SEQ_DECL_SIZE];
};
struct NimStringV2 {
	NI len;
	NimStrPayload* p;
};
typedef NU8 tyEnum_NicoButton__DuWECYQZDfo5yecT9cSNFVw;
struct tySequence__6eW0sN9cwnKC4gxJcPFupZQ_Content { NI cap; tyObject_EnemyWrappedcolonObjectType___8yhvQa9cpB762Fw7uK9bMSCw* data[SEQ_DECL_SIZE]; };
static N_INLINE(void, nimIncRef)(void* p_p0);
static N_INLINE(NI, minuspercent___system_u813)(NI x_p0, NI y_p1);
static N_INLINE(NIM_BOOL, nimDecRefIsLast)(void* p_p0);
N_LIB_PRIVATE N_NIMCALL(void, eqdestroy___main_u261)(tyObject_StageDefcolonObjectType___UcMaWIjGo9c5Bv0yG3660iQ* dest_p0);
N_LIB_PRIVATE N_NIMCALL(void, eqdestroy___main_u86)(tySequence__6eW0sN9cwnKC4gxJcPFupZQ dest_p0);
N_LIB_PRIVATE N_NIMCALL(void, eqdestroy___enemy_u118)(tyObject_EnemyWrappedcolonObjectType___8yhvQa9cpB762Fw7uK9bMSCw* dest_p0);
N_LIB_PRIVATE N_NIMCALL(void, nimRawDispose)(void* p_p0, NI alignment_p1);
N_LIB_PRIVATE N_NIMCALL(void, alignedDealloc)(void* p_p0, NI align_p1);
N_LIB_PRIVATE N_NIMCALL(void, printc__pkgZnico_u41)(NimStringV2 text_p0, NI32 x_p1, NI32 y_p2, NI32 scale_p3);
static N_INLINE(void, appendString)(NimStringV2* dest_p0, NimStringV2 src_p1);
static N_INLINE(void, copyMem__system_u1731)(void* dest_p0, void* source_p1, NI size_p2);
static N_INLINE(void, nimCopyMem)(void* dest_p0, void* source_p1, NI size_p2);
N_LIB_PRIVATE N_NIMCALL(NimStringV2, dollar___systemZdollars_u8)(NI x_p0);
N_LIB_PRIVATE N_NIMCALL(NimStringV2, rawNewString)(NI space_p0);
static N_INLINE(NI32, toPint__pkgZnicoZbackendsZcommon_u848)(NF x_p0);
static N_INLINE(NF, slash___system_u1693)(NI x_p0, NI y_p1);
static N_INLINE(NF, toFloat__system_u1681)(NI i_p0);
N_LIB_PRIVATE N_NIMCALL(NIM_BOOL, btnup__pkgZnico_u195)(tyEnum_NicoButton__DuWECYQZDfo5yecT9cSNFVw b_p0);
N_LIB_PRIVATE N_NIMCALL(void, cls__pkgZnico_u1521)(NI c_p0);
N_LIB_PRIVATE N_NOCONV(void, deallocShared)(void* p_p0);
static N_INLINE(NIM_BOOL*, nimErrorFlag)(void);
static const struct {
  NI cap; NIM_CHAR data[4+1];
} TM__6JFOy2t3I9aNgfhWVoMZYyw_2 = { 4 | NIM_STRLIT_FLAG, "Act " };
static const NimStringV2 TM__6JFOy2t3I9aNgfhWVoMZYyw_3 = {4, (NimStrPayload*)&TM__6JFOy2t3I9aNgfhWVoMZYyw_2};
static const struct {
  NI cap; NIM_CHAR data[26+1];
} TM__6JFOy2t3I9aNgfhWVoMZYyw_4 = { 26 | NIM_STRLIT_FLAG, "Press start to continue..." };
static const NimStringV2 TM__6JFOy2t3I9aNgfhWVoMZYyw_5 = {26, (NimStrPayload*)&TM__6JFOy2t3I9aNgfhWVoMZYyw_4};
N_LIB_PRIVATE NIM_CONST NI w__stage_u3 = ((NI)160);
N_LIB_PRIVATE NIM_CONST NI h__stage_u4 = ((NI)144);
extern NIM_THREADVAR NIM_BOOL nimInErrorMode__system_u4433;
static N_INLINE(NI, minuspercent___system_u813)(NI x_p0, NI y_p1) {
	NI result;
	result = ((NI) ((NU)((NU32)(((NU) (x_p0))) - (NU32)(((NU) (y_p1))))));
	return result;
}
static N_INLINE(void, nimIncRef)(void* p_p0) {
	NI T1_;
	T1_ = (NI)0;
	T1_ = minuspercent___system_u813(((NI) (ptrdiff_t) (p_p0)), ((NI)8));
	(*((tyObject_RefHeader__gnJExvuIhzi79cQetGScWGg*) (T1_))).rc += ((NI)16);
}
static N_INLINE(NIM_BOOL, nimDecRefIsLast)(void* p_p0) {
	NIM_BOOL result;
	result = NIM_FALSE;
	{
		tyObject_RefHeader__gnJExvuIhzi79cQetGScWGg* cell;
		NI T5_;
		if (!!((p_p0 == NIM_NIL))) goto LA3_;
		T5_ = (NI)0;
		T5_ = minuspercent___system_u813(((NI) (ptrdiff_t) (p_p0)), ((NI)8));
		cell = ((tyObject_RefHeader__gnJExvuIhzi79cQetGScWGg*) (T5_));
		{
			if (!((NI)((NI32)((*cell).rc) >> (NU32)(((NI)4))) == ((NI)0))) goto LA8_;
			result = NIM_TRUE;
		}
		goto LA6_;
LA8_: ;
		{
			(*cell).rc -= ((NI)16);
		}
LA6_: ;
	}
LA3_: ;
	return result;
}
N_LIB_PRIVATE N_NIMCALL(void, eqdestroy___main_u86)(tySequence__6eW0sN9cwnKC4gxJcPFupZQ dest_p0) {
	NI colontmp_;
	colontmp_ = ((NI)0);
	{
		while (1) {
			NI T3_;
			T3_ = dest_p0.len;
			if (!(colontmp_ < T3_)) goto LA2;
			{
				NIM_BOOL T6_;
				T6_ = (NIM_BOOL)0;
				T6_ = nimDecRefIsLast(dest_p0.p->data[colontmp_]);
				if (!T6_) goto LA7_;
				eqdestroy___enemy_u118(dest_p0.p->data[colontmp_]);
				nimRawDispose(dest_p0.p->data[colontmp_], ((NI)4));
			}
LA7_: ;
			colontmp_ += ((NI)1);
		} LA2: ;
	}
	if (dest_p0.p && !(dest_p0.p->cap & NIM_STRLIT_FLAG)) {
 alignedDealloc(dest_p0.p, NIM_ALIGNOF(tyObject_EnemyWrappedcolonObjectType___8yhvQa9cpB762Fw7uK9bMSCw*));
}
}
N_LIB_PRIVATE N_NIMCALL(void, eqdestroy___main_u261)(tyObject_StageDefcolonObjectType___UcMaWIjGo9c5Bv0yG3660iQ* dest_p0) {
	eqdestroy___main_u86((*dest_p0).enemies);
}
N_LIB_PRIVATE N_NIMCALL(void, eqcopy___main_u246)(tyObject_StageDefcolonObjectType___UcMaWIjGo9c5Bv0yG3660iQ** dest_p0, tyObject_StageDefcolonObjectType___UcMaWIjGo9c5Bv0yG3660iQ* src_p1) {
	{
		if (!src_p1) goto LA3_;
		nimIncRef(src_p1);
	}
LA3_: ;
	{
		NIM_BOOL T7_;
		T7_ = (NIM_BOOL)0;
		T7_ = nimDecRefIsLast((*dest_p0));
		if (!T7_) goto LA8_;
		eqdestroy___main_u261((*dest_p0));
		nimRawDispose((*dest_p0), ((NI)4));
	}
LA8_: ;
	(*dest_p0) = src_p1;
}
static N_INLINE(void, nimCopyMem)(void* dest_p0, void* source_p1, NI size_p2) {
	void* T1_;
	T1_ = (void*)0;
	T1_ = memcpy(dest_p0, source_p1, ((size_t) (size_p2)));
}
static N_INLINE(void, copyMem__system_u1731)(void* dest_p0, void* source_p1, NI size_p2) {
	nimCopyMem(dest_p0, source_p1, size_p2);
}
static N_INLINE(void, appendString)(NimStringV2* dest_p0, NimStringV2 src_p1) {
	{
		if (!(((NI)0) < src_p1.len)) goto LA3_;
		copyMem__system_u1731(((void*) ((&(*(*dest_p0).p).data[(*dest_p0).len]))), ((void*) ((&(*src_p1.p).data[((NI)0)]))), ((NI)(src_p1.len + ((NI)1))));
		(*dest_p0).len += src_p1.len;
	}
LA3_: ;
}
static N_INLINE(NI32, toPint__pkgZnicoZbackendsZcommon_u848)(NF x_p0) {
	NI32 result;
	NF T1_;
{	T1_ = (NF)0;
	T1_ = floor(x_p0);
	result = ((NI32) (T1_));
	goto BeforeRet_;
	}BeforeRet_: ;
	return result;
}
static N_INLINE(NF, toFloat__system_u1681)(NI i_p0) {
	NF result;
	result = ((NF) (i_p0));
	return result;
}
static N_INLINE(NF, slash___system_u1693)(NI x_p0, NI y_p1) {
	NF result;
	NF T1_;
	NF T2_;
	T1_ = (NF)0;
	T1_ = toFloat__system_u1681(x_p0);
	T2_ = (NF)0;
	T2_ = toFloat__system_u1681(y_p1);
	result = ((NF)(T1_) / (NF)(T2_));
	return result;
}
static N_INLINE(NIM_BOOL*, nimErrorFlag)(void) {
	NIM_BOOL* result;
	result = (&nimInErrorMode__system_u4433);
	return result;
}
N_LIB_PRIVATE N_NIMCALL(void, pre_stage__stage_u11)(tyObject_StageDefcolonObjectType___UcMaWIjGo9c5Bv0yG3660iQ* stage_p0) {
	NIM_BOOL enable_pre_stage;
NIM_BOOL* nimErr_;
{nimErr_ = nimErrorFlag();
	enable_pre_stage = (*stage_p0).enable_pre_stage;
	{
		NimStringV2 colontmpD_;
		NimStringV2 colontmpD__2;
		NI stage_num;
		NimStringV2 T6_;
		NF T7_;
		NI32 T8_;
		NF T9_;
		NI32 T10_;
		NF T11_;
		NI32 T12_;
		NF T13_;
		NI32 T14_;
		if (!enable_pre_stage) goto LA3_;
		colontmpD_.len = 0; colontmpD_.p = NIM_NIL;
		colontmpD__2.len = 0; colontmpD__2.p = NIM_NIL;
		stage_num = (*stage_p0).stage_num;
		T6_.len = 0; T6_.p = NIM_NIL;
		colontmpD_ = dollar___systemZdollars_u8(stage_num);
		if (NIM_UNLIKELY(*nimErr_)) goto LA5_;
		T6_ = rawNewString(colontmpD_.len + 4);
appendString((&T6_), TM__6JFOy2t3I9aNgfhWVoMZYyw_3);
appendString((&T6_), colontmpD_);
		colontmpD__2 = T6_;
		T7_ = (NF)0;
		T7_ = slash___system_u1693(w__stage_u3, ((NI)2));
		T8_ = (NI32)0;
		T8_ = toPint__pkgZnicoZbackendsZcommon_u848(T7_);
		if (NIM_UNLIKELY(*nimErr_)) goto LA5_;
		T9_ = (NF)0;
		T9_ = slash___system_u1693(h__stage_u4, ((NI)2));
		T10_ = (NI32)0;
		T10_ = toPint__pkgZnicoZbackendsZcommon_u848(((NF)(T9_) - (NF)(11.0)));
		if (NIM_UNLIKELY(*nimErr_)) goto LA5_;
		printc__pkgZnico_u41(colontmpD__2, T8_, T10_, ((NI32)2));
		if (NIM_UNLIKELY(*nimErr_)) goto LA5_;
		T11_ = (NF)0;
		T11_ = slash___system_u1693(w__stage_u3, ((NI)2));
		T12_ = (NI32)0;
		T12_ = toPint__pkgZnicoZbackendsZcommon_u848(T11_);
		if (NIM_UNLIKELY(*nimErr_)) goto LA5_;
		T13_ = (NF)0;
		T13_ = slash___system_u1693(h__stage_u4, ((NI)2));
		T14_ = (NI32)0;
		T14_ = toPint__pkgZnicoZbackendsZcommon_u848(T13_);
		if (NIM_UNLIKELY(*nimErr_)) goto LA5_;
		printc__pkgZnico_u41(TM__6JFOy2t3I9aNgfhWVoMZYyw_5, T12_, T14_, ((NI32)1));
		if (NIM_UNLIKELY(*nimErr_)) goto LA5_;
		{
			NIM_BOOL T17_;
			T17_ = (NIM_BOOL)0;
			T17_ = btnup__pkgZnico_u195(((tyEnum_NicoButton__DuWECYQZDfo5yecT9cSNFVw)14));
			if (NIM_UNLIKELY(*nimErr_)) goto LA5_;
			if (!T17_) goto LA18_;
			cls__pkgZnico_u1521(((NI)0));
			if (NIM_UNLIKELY(*nimErr_)) goto LA5_;
			(*stage_p0).enable_pre_stage = NIM_FALSE;
			(*stage_p0).enable_stage = NIM_TRUE;
		}
LA18_: ;
		{
			LA5_:;
		}
		{
			if (colontmpD__2.p && !(colontmpD__2.p->cap & NIM_STRLIT_FLAG)) {
 deallocShared(colontmpD__2.p);
}
			if (colontmpD_.p && !(colontmpD_.p->cap & NIM_STRLIT_FLAG)) {
 deallocShared(colontmpD_.p);
}
		}
		if (NIM_UNLIKELY(*nimErr_)) goto BeforeRet_;
	}
LA3_: ;
	}BeforeRet_: ;
}
N_LIB_PRIVATE N_NIMCALL(void, eqdestroy___main_u243)(tyObject_StageDefcolonObjectType___UcMaWIjGo9c5Bv0yG3660iQ* dest_p0) {
	{
		NIM_BOOL T3_;
		T3_ = (NIM_BOOL)0;
		T3_ = nimDecRefIsLast(dest_p0);
		if (!T3_) goto LA4_;
		eqdestroy___main_u261(dest_p0);
		nimRawDispose(dest_p0, ((NI)4));
	}
LA4_: ;
}
